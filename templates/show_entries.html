{% extends "layout.html" %}
{% block body %}
  {% if session.logged_in %}
    <form action="{{ url_for('add_entry') }}" method=post class=add-entry>
      <dl>
        <dt>Description:
        <dd><input type=text size=30 name=description>
        <dt>Amount:
        <dd><input type=text size=30 name=amount>
        <dt>From:
        <dd><input type=text size=30 name=srcbucket>
        <dt>To:
        <dd><input type=text size=30 name=destbucket>
        <dd><input type=submit value=Share>
      </dl>
    </form>
  {% endif %}

  <a href="{{ url_for('show_buckets') }}">Show Buckets</a>

  <img src="{{ url_for('history_png') }}" />

  <table class="entries">
    <tr>
      <th>Amount</th>
      <th>From</th>
      <th>To</th>
      <th>&nbsp;</th>
      {% for internal in internals %}
      <th>{{ internal.bucketname }}</th>
      {% endfor %}
    </tr>
    <tr class=resultingbalance>
      <td colspan=3>&nbsp;</td>
      <td>Initial balance: </td>
      {% for internal in internals %}
      <td align="right">{{ internal.initialbalancestring }}</td>
      {% endfor %}
    </tr>
  {% for entry in entries %}
    <tr>
      <td align="right">{{ entry.amountstring }}</td>
      <td>{{ entry.srcbucket }}</td>
      <td>{{ entry.destbucket }}</td>
      <td>Change in balance:</td>
      {% for internal in entry.internals %}
      <td align="right">{{ internal }}</td>
      {% endfor %}
    </tr>
    <tr class=resultingbalance>
      <td colspan=3>{{ entry.description }}&nbsp;</td>
      <td>Resulting balance:</td>
      {% for balance in entry.balances %}
      <td align="right">{{ balance }}</td>
      {% endfor %}
    </tr>
  {% else %}
    <tr><td><em>Unbelievable.  No entries here so far</em></td></tr>
  {% endfor %}
    <!-- TODO: put new-entry form at bottom row of table -->
  </table>
{% endblock %}
